---
import { getImage } from 'astro:assets'

export interface PictureProps {
  image: string
  alt: string
  loading?: 'lazy' | 'eager'
  class?: string
}

// Props
const { image, alt, loading, class: className } = Astro.props

// Image formats
const webpImage = await getImage({ src: image, format: 'webp' })
const jpegImage = await getImage({ src: image, format: 'jpeg' })
---

<picture>
  <source srcset={webpImage.src} type="image/webp" />
  <source srcset={jpegImage.src} type="image/jpeg" />
  <img
    class={className}
    src={jpegImage.src}
    alt={alt}
    loading={loading ? loading : 'lazy'}
    decoding="async"
  />
</picture>

<style>
  img {
    display: block;
    width: 100%;
    height: auto;
  }
</style>
